# イテレーション計画・管理ガイドライン

このドキュメントは、記念日プレゼント予約・配送サービス開発におけるイテレーション（開発サイクル）の計画と管理方法を定義します。アジャイルなアプローチに基づき、継続的な価値提供とプロセス改善を目指します。

**現在の開発体制（開発者1名とAIによるペアプログラミング）を反映しつつ、将来的なチーム開発への移行も考慮してプロセスを定義します。**

## 基本原則

* **イテレーションベース:** 定められた期間（イテレーション）ごとに計画・実行・レビュー・振り返りを行います。
* **優先順位付け:** プロダクトロードマップとビジネス価値に基づき、タスクの優先順位を明確にします。
* **透明性:** 計画、進捗、課題をチーム内で可視化し、共有します。
* **適応性:** 状況の変化に応じて計画を柔軟に見直し、調整します。
* **継続的改善:** 定期的な振り返りを通じて、プロセスを改善し続けます。

## イテレーションプロセス

### 1. イテレーション期間

* **期間:** **1週間** を基本とします。
  * *理由: 頻繁なフィードバックループと計画修正を可能にし、初期段階での学習速度を高めるため。将来的にはチームの状況に応じて見直します。*
  * **開始曜日:** 原則として **日曜日** に計画を開始し、その週の土曜日までを実行期間とします。
  * **※ サイドプロジェクトのため、開始・終了タイミングは目安とし、状況に応じて柔軟に調整します。**

### イテレーション期間とタスク完了に関する調整

* **イテレーションが予定より早く終了した場合:**
  * 原則として、次回のイテレーション開始日は変更しません。
  * 空いた時間は、以下の活動に柔軟に活用します:
    * 技術タスクバックログ (`docs/technical_tasks.md`) にあるタスクの消化。
    * ドキュメントの改善・拡充。
    * 関連技術の学習や調査。
    * 次期イテレーションの準備（タスクの事前調査など）。
    * 休憩、リフレッシュ。
  * 実施した活動は、次のイテレーションバックログの「イテレーション間活動記録」セクションに任意で記録します。
* **イテレーション期間内にタスクが完了しなかった場合:**
  * イテレーションは予定通り終了し、レビューと振り返りを実施します。
  * 未完了のタスクは、次回のイテレーション計画ミーティングに持ち越します。
  * 計画ミーティングで、未完了タスクの必要性、優先度、分割可能性などを再評価し、改めて計画に含めるか、バックログに戻すかを決定します。
  * 振り返りでは、タスクが完了しなかった理由（見積もり精度、予期せぬ問題、スコープ変更など）を議論し、プロセスの改善点を探ります。

### 2. 計画 (Planning)

* **タイミング:** 各イテレーションの開始時（例: 月曜日の午前）に実施します。
* **所要時間:** 30分〜1時間程度を目安とします。
* **参加者:** **開発者（あなた）とAI。** （将来チームになった場合は開発チーム全員とプロダクトオーナー）
* **インプット:**
  * プロダクトロードマップ (`docs/product/roadmap.md`)
  * ユーザーストーリーマップ (`docs/requirements/user_story_mapping.md`)
  * 技術タスクバックログ (`docs/technical_tasks.md`)
  * 前回のイテレーションの振り返り結果 (Try項目など)
* **アクティビティ:**
    1. **イテレーションゴールの設定:** このイテレーションで達成したい具体的な目標（例: 「ユーザー登録機能を実装し、テストを完了する」「○○に関する技術的負債を解消する」）をチームで合意します。ゴールは1〜2個程度に絞り、明確で測定可能なものにします。
    2. **タスクの選択と優先順位付け:**
        * ゴール達成に必要なユーザーストーリーや技術タスクを、各バックログから選択します。
        * **各選択タスクについて、目的・ゴールを明確にし、主要なサブタスクに分解します。**（詳細なサブタスク化は各タスク着手時でも可）
        * **優先順位付けの指針:**
            * プロダクトロードマップの Now > Next > Later を最優先します。
            * ユーザーストーリー間の依存関係（例: アカウント登録がログインより先）を考慮します。
            * 技術的リスクやブロッカーとなる技術タスクを優先的に解消します。
            * 完了の定義を満たすために必要なタスク（テスト、ドキュメント更新など）も忘れずに含めます。
            * チームのベロシティ（過去の実績から予測される消化可能なタスク量）を考慮し、現実的な量のタスクを選択します。（初期は予測が難しいため、少なめに見積もる）
    3. **(任意) 見積もり:** 選択したタスクの相対的な規模を見積もります（例: ストーリーポイント）。これはベロシティ計測や計画精度向上のために行いますが、初期段階では省略可能です。
    4. **(任意) 担当割り振り:** （現在は開発者1名のため、割り振りは自明ですが、将来のチーム開発では重要になります。）
* **アウトプット:**
  * **イテレーションバックログ:** そのイテレーションで取り組むタスクのリスト、イテレーションゴール、(任意)見積もり、(任意)担当者を記載したもの。
    * **管理方法:** `docs/process/iteration_template.md` をコピーし、`docs/process/iterations/YYYY-WW.md` (例: `2025-W18.md`) というファイル名で保存して、内容を計画会議で決定した情報（期間、ゴール、タスクリスト）で埋めます。GitHub Projects や Issue Tracker の利用も将来的に検討します。
    * **タスクと上位項目との関連:** イテレーションバックログに記載する各タスクには、関連するユーザーストーリー (`user_story_mapping.md`) や技術タスク (`technical_tasks.md`) への参照リンクを `(Ref: <path_to_doc>#<target_section_or_item>)` の形式で付記することを推奨します。これにより、個々の作業がプロダクト全体のどの部分に貢献するのかを追跡しやすくなります。
    * **上位項目の完了:** 参照元の `user_story_mapping.md` や `technical_tasks.md` の項目は、それを達成するために必要な全てのイテレーションタスクが完了した時点で `[x]` とマークします。

### イテレーションバックログ作成手順

1. `docs/process/iteration_template.md` ファイルをコピーします。
2. コピーしたファイルを `docs/process/iterations/` ディレクトリ内に `YYYY-WW.md` (例: `2025-W18.md`) という名前で保存します。
3. ファイルを開き、イテレーション計画会議の結果に基づき、以下のセクションを編集します:
    * ファイル冒頭のタイトル (`# イテレーション YYYY-WXX バックログ`) の `YYYY-WXX` を正しい週番号に更新します。
    * `期間:` を正しい日付に更新します。
    * `ゴール:` を設定したイテレーションゴールで更新します。
    * `タスクリスト` セクションに、選択したタスクをConventional Commit形式で記述し、必要に応じて関連ドキュメントへの参照 (`Ref: ...`) を追加します。
4. 他のセクション（レビューまとめ、チェックリスト、振り返り）は、イテレーション完了時に記入するため、この時点では空のままにしておきます。
5. 作成したイテレーションバックログファイルをコミットします。

### 3. 実行 (Execution)

* 開発者はイテレーションバックログに従ってタスクを進めます。
* **進捗確認:**
  * **方法:** ペアプログラミングを通じて常時進捗と課題を共有します。必要に応じて非同期で記録・相談します。
  * **目的:** スムーズな開発の維持、ブロッカーの早期解決。
* **完了の定義 (Definition of Done - DoD):** タスクが「完了」とみなされるための基準です。以下を共通の DoD とします。
  * 関連するコードが実装されている。
  * 単体テスト・結合テストが記述され、**CIでの `cargo test` がパスする。** （CI環境の早期構築が望ましい）
  * `cargo fmt` および `cargo clippy` で警告が出ない。
  * 関連するドキュメント（**ユビキタス言語、ドメインモデル**、ADR、READMEなど）が更新されている。
  * **レビュー:** ペアプログラミングを通じて常時レビューが行われていることを前提とします。（将来チームになった場合は別途コードレビュープロセスを定義）
  * main (または develop) ブランチにマージされている。（Pull Request は当面省略）
  * (ユーザーストーリーの場合) 受け入れ基準（ユーザーストーリーに記載）を満たしていることが確認されている。

### 4. レビュー (Review)

* **タイミング:** イテレーションの最終日（例: 金曜日の午後）に実施します。
* **所要時間:** 30分〜1時間程度を目安とします。
* **参加者:** **開発者（あなた）とAI。** （将来チームになった場合は関係者も招待）
* **目的:** イテレーションで完了した成果物を確認し、学習とフィードバックを得る。イテレーションゴール達成を確認する。（現在の体制では形式的なデモより、完了物の確認と次の計画への接続を重視）
* **アクティビティ:**
  * 完了したタスクと成果物の確認。
  * 質疑応答、自己フィードバック。
  * プロダクトロードマップや次期イテレーション計画への影響を議論。
  * **イテレーションバックログファイルの「レビューまとめ」セクションを記入する。**
  * **イテレーションバックログファイルの「イテレーション完了時チェックリスト」を確認し、実行する。**

### 5. 振り返り (Retrospective)

* **タイミング:** イテレーションレビューの後、またはイテレーション最終日に実施します。
* **所要時間:** 30分程度を目安とします。
* **参加者:** **開発者（あなた）とAI。** （将来チームになった場合も、基本は開発チーム内での実施を推奨）
* **目的:** イテレーション中のプロセス（良かった点、問題点、改善点）を振り返り、次のイテレーションに向けた具体的な改善アクション（Try）を決定する。
* **手法:** KPT (Keep/Problem/Try) など。
* **アクティビティ:**
  * Keep, Problem, Try を洗い出す。
  * **AI アシスタントのルール (`@rules` や `.cursor/rules/` 内ファイル) について、当イテレーションでの活動を踏まえ、変更や追加の必要性がないか確認し、必要であれば AI アシスタントにレビューや改善案の作成を依頼する。**
* **アウトプット:**
  * 振り返り結果の記録（Keep, Problem）。
  * 具体的な改善アクション（Try）のリスト。Try は次のイテレーション計画のインプットとなります。
  * **(任意) AI アシスタントルールの更新または更新案。**
  * **管理方法:** イテレーションバックログファイル (`docs/process/iterations/YYYY-WW.md`) の「振り返り (Retrospective)」セクションに追記する形で管理します。

## 今後の検討事項

* Issue Tracker / Project Management Tool の導入検討。
* 見積もり手法（ストーリーポイント等）の導入とベロシティ計測。
* より詳細な完了の定義（テストカバレッジ基準など）。
* リリースプロセスとの連携。
