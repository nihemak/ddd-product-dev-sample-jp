# ADR 0005: システム構成としてSPA + APIアーキテクチャを採用

*   **Status**: Accepted
*   **Date**: 2025-04-20
*   **Deciders**: (議論参加者)

## Context and Problem Statement

Webアプリケーションとしてサービスを提供することを決定 (ADR 0004) したが、具体的なシステム構成（フロントエンドとバックエンドの連携方法）を決定する必要がある。主な選択肢として、SPA (Single Page Application) + バックエンドAPI構成と、SSR (Server-Side Rendering) 構成が考えられる。

## Decision Drivers

*   **将来的な拡張性**: PWA化やネイティブモバイルアプリ展開の可能性を考慮したい。
*   **関心の分離**: フロントエンドとバックエンドの責務を明確に分離したい。
*   **技術スタックの選択肢**: バックエンド (Rust) とは独立して、フロントエンド技術を選定・進化させたい。
*   **開発のしやすさ・エコシステム**: 一般的で開発者コミュニティが活発な構成を採用したい。
*   **サンプルとしての価値**: 現代的なWebアプリケーション構成のサンプルとして分かりやすいものにしたい。

## Considered Options

1.  **SPA + バックエンドAPI**: フロントエンドはJavaScriptフレームワーク等で構築されたSPAとし、バックエンドはJSON APIなどを提供する構成。
    *   Pros: フロントエンド/バックエンドの明確な分離、将来的な拡張性（API再利用）、独立した技術選定・開発・デプロイ、豊富なフロントエンドエコシステム。
    *   Cons: 初期ロードが遅くなる可能性、SEO対策に追加の配慮が必要な場合がある、API設計・管理の必要性。
2.  **SSR (Server-Side Rendering)**: サーバーサイド（この場合Rust）でHTMLをレンダリングして返す構成。フロントエンドのロジックも一部サーバーサイドで実行される場合がある。
    *   Pros: 初期ロードが速い傾向、SEOに有利な場合が多い、比較的シンプルな構成から始められる。
    *   Cons: フロントエンド/バックエンドの結合度が高くなりやすい、APIを外部公開・再利用しにくい、フロントエンド技術の選択肢がバックエンドに依存する場合がある。

## Decision Outcome

**選択肢1「SPA + バックエンドAPI」構成を採用する。**

理由:
*   フロントエンドとバックエンドを明確に分離することで、将来的にPWA化やモバイルアプリ展開（API再利用）を行う際の柔軟性が最も高い。
*   DDDやオニオンアーキテクチャで目指す関心の分離を、システム全体に適用できる。
*   バックエンドAPIとフロントエンドSPAは、それぞれ独立して技術選定、開発、テスト、デプロイが可能になる。
*   「SPA + API」は現代のWeb開発における主流パターンの一つであり、開発者コミュニティやエコシステムが成熟しているため、サンプルとしての参考価値も高い。
*   APIスキーマを明確に定義する必要性は、むしろ開発プロセスにおける良い副作用（仕様の明確化）と捉えることができる。
*   初期ロードやSEOに関する懸念は、近年の技術やサービス特性を考慮すると許容範囲内と判断。

## Consequences

### Positive:
*   フロントエンドとバックエンドの関心が明確に分離される。
*   将来的なクライアント（PWA, Mobile App）追加時のAPI再利用が容易になる。
*   フロントエンドとバックエンドで独立した技術選択・開発・デプロイサイクルが可能になる。
*   明確なAPI境界を持つことで、チーム開発（仮）やテストがしやすくなる。

### Negative:
*   APIの設計、バージョニング、ドキュメンテーション（スキーマ管理）が必須となる。
*   クライアントサイドでの状態管理がSSR構成より複雑になる可能性がある。
*   初期表示速度やSEOに関して、SSR構成に比べて不利になる可能性がある（対策は可能）。

## References

*   ADR 0004: サービス提供形態としてWebアプリケーションを採用 