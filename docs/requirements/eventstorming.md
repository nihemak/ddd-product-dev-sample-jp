# イベントストーミング図

**注意:** このドキュメントの主たる情報は以下の図にあります。図の編集は Draw.io (diagrams.net) または対応する VS Code 拡張機能を使用してください。

![イベントストーミング図](eventstorming.drawio.svg)

---

以下は、図の内容をテキストで補足・リスト化したものです。

## イベントストーミング (テキスト補足)

これは、プロダクトビジョンと初期の要求から抽出した要素に基づき、イベントストーミングの初期段階の発見事項を記録するためのものです。
実際のワークショップを通じて、これらの要素はさらに詳細化・洗練される必要があります。

## 概要

*   **目的**: 記念日プレゼントの予約・配送サービスにおける主要なビジネスプロセスとドメイン要素を洗い出す。
*   **インプット**: `docs/product/roadmap.md` (主要テーマ/機能), `docs/product/vision_strategy.md` (ビジョン/課題)
*   **ベース**: プロダクト定義ドキュメントに基づく初期の要求分析。

## 発見された要素（初期候補）

### アクター (Actors - 黄色)

*   顧客 (プレゼントを送りたいユーザー)
*   システム (通知など)
*   管理者 (プレゼントの準備・発送などバックオフィス業務担当)

### コマンド (Commands - 青)

*   (顧客) アカウントを登録する
*   (顧客) ログインする
*   (顧客) 届け先を登録する
*   (顧客) 届け先を選択する
*   (顧客) 記念日を指定する
*   (顧客) メッセージを入力する
*   (顧客) 発送代行を依頼する (ユーザー準備プレゼント情報入力)
*   (顧客) 商品を選択する (カタログから)
*   (顧客) プレゼント手配を依頼する
*   (顧客) ラッピングを選択する
*   (顧客) 配送日時を指定する
*   (顧客) 予約内容を確認する
*   (顧客) 予約を変更する
*   (顧客) 予約をキャンセルする
*   (顧客) 支払いを行う
*   (管理者) 予約内容を確認する
*   (管理者) プレゼント発送準備中にする
*   (管理者) プレゼントを発送する
*   (システム) リマインダー通知を送信する
*   (システム) 予約関連通知を送信する（発送準備）
*   (システム) 予約関連通知を送信する（完了）

### ドメインイベント (Domain Events - オレンジ)

*   アカウントが登録された
*   ログインに成功した
*   届け先が登録された
*   プレゼント発送代行が予約された
*   プレゼント手配が予約された
*   ラッピングが選択された
*   配送日時が指定された
*   予約が変更された
*   予約がキャンセルされた
*   支払いが行われた
*   プレゼント発送準備中にされた
*   プレゼントが発送された
*   記念日が近づいた (システム/時間経過イベント)
*   発送日が近づいた (システム/時間経過イベント)
*   プレゼント配送が完了した (外部イベント?)

### 集約 (Aggregates - ピンク)

*   ユーザーアカウント
*   届け先
*   プレゼント予約 - 中心的な集約になりそう
*   商品 - カタログ用
*   支払い

### Read Model / 情報 (緑)

*   予約詳細
*   予約一覧
*   商品カタログ
*   届け先一覧
*   支払い履歴
*   マイページ情報

## ワークフローの例 (プレゼント発送代行予約 - MVP想定)

1.  顧客が **アカウントを登録する** -> **アカウントが登録された**
2.  顧客が **ログインする** -> **ログインに成功した**
3.  顧客が **届け先を登録する** -> **届け先が登録された**
4.  顧客が **発送代行を依頼する** (届け先選択、記念日指定、メッセージ入力、商品情報入力) -> **プレゼント発送代行が予約された**
5.  (予約内容が **予約詳細** Read Model に反映される)
6.  (時限) **記念日が近づいた** -> システムが **リマインダー通知を送信する**
7.  (時限) **発送日が近づいた** -> システムが **予約関連通知を送信する** (発送準備通知)
8.  管理者が **プレゼント発送準備中にする** -> **プレゼント発送準備中にされた**
9.  管理者が **プレゼントを発送する** -> **プレゼントが発送された**
10. (外部連携?) **プレゼント配送が完了した** -> システムが **予約関連通知を送信する** (完了通知)

**注意:** 上記は初期の洗い出し結果であり、実際のイベントストーミングワークショップで詳細化・検証が必要です。特にエラーケース、代替フロー、キャンセル処理、外部システム連携などはさらに深掘りする必要があります。
